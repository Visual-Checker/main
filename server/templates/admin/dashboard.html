<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ - ì¶œê²°ê´€ë¦¬ ì‹œìŠ¤í…œ</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #f5f5f5; }
        .header { background: #2196F3; color: white; padding: 15px 30px; display: flex; justify-content: space-between; align-items: center; }
        .header h1 { font-size: 24px; }
        .logout-btn { background: #1976D2; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; }
        .container { padding: 30px; max-width: 1400px; margin: 0 auto; }
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .stat-card { background: white; padding: 25px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .stat-card h3 { color: #666; font-size: 14px; margin-bottom: 10px; }
        .stat-value { font-size: 36px; font-weight: bold; color: #2196F3; }
        .nav-tabs { display: flex; gap: 10px; margin-bottom: 20px; }
        .nav-tabs a { padding: 10px 20px; background: white; border-radius: 8px 8px 0 0; text-decoration: none; color: #333; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .nav-tabs a.active { background: #2196F3; color: white; }
        .content-section { background: white; padding: 30px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { padding: 12px; text-align: left; border-bottom: 1px solid #ddd; }
        th { background: #f5f5f5; font-weight: 600; }
        .status-badge { padding: 4px 12px; border-radius: 12px; font-size: 12px; font-weight: 500; }
        .status-present { background: #C8E6C9; color: #2E7D32; }
        .status-absent { background: #FFCDD2; color: #C62828; }
        .status-late { background: #FFE082; color: #F57F17; }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ“Š ì¶œê²°ê´€ë¦¬ ì‹œìŠ¤í…œ - ê´€ë¦¬ì</h1>
        <button class="logout-btn" onclick="location.href='/admin/logout'">ë¡œê·¸ì•„ì›ƒ</button>
    </div>
    <div class="container">
        <div class="stats-grid">
            <div class="stat-card">
                <h3>ì „ì²´ ê²€ì¶œ ìˆ˜</h3>
                <div class="stat-value" id="total-detections">-</div>
            </div>
            <div class="stat-card">
                <h3>í™œì„± í•™ìƒ</h3>
                <div class="stat-value" id="total-students">-</div>
            </div>
            <div class="stat-card">
                <h3>ì˜¤ëŠ˜ ì¶œì„</h3>
                <div class="stat-value" id="today-attendance">-</div>
            </div>
            <div class="stat-card">
                <h3>í™œì„± í´ë¼ì´ì–¸íŠ¸</h3>
                <div class="stat-value" id="active-clients">-</div>
            </div>
        </div>
        <div class="nav-tabs">
            <a href="/admin" class="active">ëŒ€ì‹œë³´ë“œ</a>
            <a href="/admin/realtime">ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°</a>
            <a href="/admin/students">í•™ìƒ ê´€ë¦¬</a>
            <a href="/admin/reports">ë³´ê³ ì„œ</a>
        </div>
        <div class="content-section">
            <h2>ìµœê·¼ ì¶œì„ ì´ë²¤íŠ¸</h2>
            <table id="events-table">
                <thead>
                    <tr>
                        <th>í•™ìƒ ID</th>
                        <th>ì œìŠ¤ì²˜</th>
                        <th>ì‹ ë¢°ë„</th>
                        <th>ì‹œê°„</th>
                        <th>ìƒíƒœ</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- ë™ì ìœ¼ë¡œ ì±„ì›Œì§ -->
                </tbody>
            </table>
        </div>
    </div>
    <script>
        async function updateStats() {
            try {
                const response = await fetch('/admin/api/statistics');
                const stats = await response.json();
                document.getElementById('total-detections').textContent = stats.total_detections || 0;
                document.getElementById('total-students').textContent = stats.total_students || 0;
                document.getElementById('today-attendance').textContent = stats.today_attendance || 0;
                document.getElementById('active-clients').textContent = stats.active_clients || 0;
            } catch (error) { console.error('Error fetching stats:', error); }
        }
        async function updateEvents() {
            try {
                const response = await fetch('/admin/api/attendance-events');
                const events = await response.json();
                const tbody = document.querySelector('#events-table tbody');
                tbody.innerHTML = '';
                events.slice(0, 20).forEach(event => {
                    const row = tbody.insertRow();
                    row.innerHTML = `
                        <td>${event.student_id}</td>
                        <td>${event.gesture}</td>
                        <td>${(event.confidence * 100).toFixed(1)}%</td>
                        <td>${new Date(event.timestamp * 1000).toLocaleString()}</td>
                        <td><span class="status-badge status-${event.status}">${event.status}</span></td>
                    `;
                });
            } catch (error) { console.error('Error fetching events:', error); }
        }
        updateStats();
        updateEvents();
        setInterval(() => { updateStats(); updateEvents(); }, 5000);
    </script>
</body>
</html>